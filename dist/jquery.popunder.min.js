/*! jquery-plugin to create popunders in major browsers., 0.2.54 https://github.com/hpbuniat/jquery-popunder
Copyright (c) 2016 Hans-Peter Buniat, BSD license https://github.com/hpbuniat/jquery-popunder/blob/master/LICENSE*/
!function(a,b,c,d,e){"use strict";a.popunder=function(c,d,e,f){var g=a.popunder.helper;if(g.getMethod(),0===arguments.length&&(c=b.aPopunder),e||d)g.bindEvents(c,d,e);else if(c="function"==typeof c?c(f):c,g.ua.ie!==!0&&g.ua.g!==!0||(c=g.handleTargetBlank(c,f)),g.reset(),typeof c!==g.u){do g.queue(c,f),g.first=!1;while(c.length>0);g.queue(c,f)}return a},a.popunder.helper={_top:b.self,lastWin:null,lastTarget:null,f:!1,last:!1,first:!0,b:"about:blank",u:"undefined",o:null,du:"__jqpu",ua:{ie:!!/msie|trident/i.test(d.userAgent),oldIE:!!/msie/i.test(d.userAgent),ff:!!/firefox/i.test(d.userAgent),o:!!/opera/i.test(d.userAgent),g:!!/chrome/i.test(d.userAgent),w:!!/webkit/i.test(d.userAgent),linux:!!/linux/i.test(d.userAgent),touch:"ontouchstart"in e.documentElement||!!/bada|blackberry|iemobile|android|iphone|ipod|ipad/i.test(d.userAgent)},m:{ie:"simple",ff:"pop",w:"tab",g:"switcher",o:"switcher",linux:"switcher"},hs:[],ns:"jqpu",def:{window:{toolbar:0,scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,width:(c.availWidth-122).toString(),height:(c.availHeight-122).toString(),screenX:0,screenY:0,left:0,top:0},name:"__pu",cookie:"__puc",blocktime:!1,skip:{},cb:null,popup:!1},testStack:function(a,b){var c,d=!1;for(c in a)a.hasOwnProperty(c)&&a[c]&&b[c]&&(d=a[c]);return d},getMethod:function(){var a=this;return"object"==typeof a.m&&(a.m=a.testStack(a.m,a.ua)),a.ua.touch&&(a.m="switcher"),a},queue:function(a,b){var c=!1,d=this;if(a.length>0)for(;c===!1;){var e=a.shift();c=e?d.open(e[0],e[1]||{},a.length,b):!0}else d.last===!1?(d.last=!0,d.bg().href(!0)):d.f||d.ua.g||d.ua.ie||d.bg();return d},handler:function(a,b){var c=this;"function"==typeof c.hs[a]&&c.hs[a](b)},getTrigger:function(b){return a("#"+b).parents(".jq-pu").children().eq(0)},bindEvents:function(b,c,d){var e=this,f="string",g=e.ua.touch?"touchstart click":"click",h=e.hs.length,i=function(a){return function(b){e.handler(a,b)}}(h);return e.hs[h]=function(b){return function(c){return c&&!c.target&&(c={target:e.getTrigger(c)}),a.popunder(b,!1,!1,c),!0}}(b),!c||e.ua.g||e.ua.w||e.ua.touch||(c=typeof c===f?a(c):c,c.on("submit."+e.ns,i)),d&&(d=typeof d===f?a(d):d,d.on(g+"."+e.ns,i)),e},cookieCheck:function(b,c){var d=this,e=d.rand(c.cookie,!1),f=a.cookie(e),g=!1;return f?-1===f.indexOf(b)?f+=b:g=!0:f=b,a.cookie(e,f,{expires:new Date((new Date).getTime()+6e4*c.blocktime)}),g},rand:function(a,b){var c=this,d=a?a:c.du;return d+(b===!1?"":Math.floor(89999999*Math.random()+1e7).toString()).replace(".","")},open:function(c,d,e,f){var g,h,i=this,j="function";if(h=a.extend(!0,{},i.def,d),i.o=c,top!==b.self)try{top.document.location.toString()&&(i._top=top)}catch(k){}return i.testStack(h.skip,i.ua)?!1:h.blocktime&&typeof a.cookie===j&&i.cookieCheck(c,h)?!1:(c!==i.du&&(i.lastTarget=c,i.first===!0&&"switcher"===i.m?(g=i.getFormUrl(f),g&&(f.preventDefault(),i.switcher.switchWindow(g,i.o,i.rand(h.name,!d.name)))):!0===i.isTab()?i.switcher.tab(i,i.o):i.first!==!0&&!0!==i.isMultiple()||(i.lastWin=i._top.window.open(i.o,i.rand(h.name,!d.name),i.getOptions(h.window))||i.lastWin),i.ua.ff===!0&&i.bg(),i.href(e),typeof h.cb===j&&h.cb(i.lastWin)),!0)},bg:function(a){var b=this;return b.lastWin&&b.lastTarget&&!a?b.ua.ie===!0?(b.switcher.simple(b),setTimeout(function(){b.switcher.simple(b)},500)):b.switcher.pop(b):"oc"===a&&b.switcher.pop(b),b},switcher:{simple:function(a){a.ua.oldIE?(a.lastWin.blur(),a.lastWin.opener.window.focus(),b.self.window.focus(),b.focus()):e.focus()},pop:function(a){!function(b){try{a.f=b.window.open(a.b),a.f&&a.f.close()}catch(c){}try{b.opener.window.focus()}catch(c){}}(a.lastWin)},tab:function(c,d){var f="",g=d?d:"data:text/html,<scr"+f+"ipt>window.close();</scr"+f+"ipt>;",h=!d,i=a("<a/>",{href:g}).appendTo(e.body),j=e.createEvent("MouseEvents");h=!0===c.isTab()?!h:h,j.initMouseEvent("click",!h,!0,b,0,0,0,0,0,h,!1,!h,h,0,null),d?setTimeout(function(){b.getSelection().empty()},250):(i[0].dispatchEvent(j),i[0].parentNode.removeChild(i[0]))},switchWindow:function(a,c,d){b.open(a,d),b.location.assign(c)}},isTab:function(){return"tab"===this.m},isMultiple:function(){return"pop"===this.m||"simple"===this.m},href:function(a){var b,c=this;return a&&c.lastTarget&&c.lastWin&&c.lastTarget!==c.b&&c.lastTarget!==c.o&&(!0===c.isTab()?(b=c.lastWin.document,b.open(),b.write("<html><head><title>"+e.title+'</title><script type="text/javascript">window.location="'+c.lastTarget+'";</script></head><body></body></html>'),b.close()):c.lastWin.document.location.href=c.lastTarget),c},handleTargetBlank:function(a,b){if(b&&typeof b.target!==this.u){var c=this,d=c.getFormUrl(b,!1);d&&(c.ua.ie||(d=c.du),a.unshift([d,{popup:!0}]))}return a},getFormUrl:function(b,c){var d,e,f,g=this,h=":submit, button",i=a(b.target);return i.is(h)!==!0?(i=i.parents(h),d=i.parents("form")):d=a(b.target.form),typeof c===g.u&&(c=!0),0!==i.length&&0!==d.length&&(f=d.attr("method")+"","get"!==f.toLowerCase()||"_blank"!==d.attr("target")&&!c||(e=d.attr("action")+"/?"+d.serialize())),e},reset:function(){var a=this;return a.f=a.last=!1,a.first=!0,a.lastTarget=a.lastWin=null,a},unbind:function(c,d){var e=this,f="string";return e.reset(),c&&(c=typeof c===f?a(c):c,c.off("submit."+e.ns)),d&&(d=typeof d===f?a(d):d,d.off("click."+e.ns).next(".jq-pu object").remove(),d.unwrap()),b.aPopunder=[],e},getOptions:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b+"="+a[b]);return c.join(",")}}}(jQuery,window,screen,navigator,document);