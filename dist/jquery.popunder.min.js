/*! jquery-plugin to create popunder in major browsers., 0.3.2 https://github.com/hpbuniat/jquery-popunder
Copyright (c) 2022 Hans-Peter Buniat, BSD-3-Clause license */

!function(t,e,n,i,o){"use strict";t.popunder=function(n,i,o,r){var s=t.popunder.helper;if(s.init(),typeof Cookies!==s.u&&(s.c=Cookies.noConflict()),0===arguments.length?n=e.aPopunder:typeof n!==s.fu&&t(n).is("a")&&(r=t.Event("click",{target:n}),n=e.aPopunder),o||i)s.bindEvents(n,i,o);else if(n=typeof n===s.fu?n(r):n,s.reset(),typeof n!==s.u)do{s.queue(n,r),s.first=!1}while(n.length>0);return t},t.popunder.helper={TIMEOUT:"timeout",SWITCHER:"switcher",SIMPLE:"simple",_top:e.self,lastWin:null,lastTarget:null,last:!1,first:!0,b:"about:blank",u:"undefined",fu:"function",o:null,c:null,du:"__jqpu",ua:{ie:/msie|trident/i.test(i.userAgent),oldIE:/msie/i.test(i.userAgent),edge:/edge/i.test(i.userAgent),ff:/firefox/i.test(i.userAgent),o:/opera/i.test(i.userAgent),g:/chrome/i.test(i.userAgent),w:/webkit/i.test(i.userAgent),linux:/linux/i.test(i.userAgent),touch:"ontouchstart"in o.documentElement||/bada|blackberry|iemobile|android|iphone|ipod|ipad/i.test(i.userAgent)},m:!1,ns:"jqpu",def:{window:{toolbar:0,scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,width:(n.availWidth-122).toString(),height:(n.availHeight-122).toString(),screenX:0,screenY:0,left:0,top:0},name:"__pu",cookie:"__puc",blocktime:!1,skip:{},cb:null,popup:!1},testStack:function(t,e){var n,i=!1;for(n in t)t.hasOwnProperty(n)&&t[n]&&e[n]&&(i=t[n]);return i},init:function(){var t=this;return t.m||(t.m=t.testStack({ff:t.SWITCHER,ie:t.SWITCHER,edge:t.SWITCHER,w:t.SWITCHER,g:t.SWITCHER,o:t.SWITCHER,linux:t.SWITCHER,touch:t.SWITCHER},t.ua)),t},queue:function(t,e){var n=!1,i=this;if(t.length>0)for(;!1===n;){var o=t.shift();n=!o||i.open(o[0],o[1]||{},t.length,e)}return 0===t.length&&(i.bg(),i.m!==i.TIMEOUT&&i.href(!0,i)),i},bindEvents:function(e,n,i){var o=this,r="string",s=function(e){return t.popunder(e.data.stack,!1,!1,e),!0};return n&&o.m!==o.SWITCHER&&(n=typeof n===r?t(n):n).on("submit."+o.ns,{stack:e},s),i&&(i=typeof i===r?t(i):i).on("click."+o.ns,{stack:e},s),o},cookieCheck:function(t,e){var n=this,i=n.rand(e.cookie,!1),o=n.c.get(i),r=!1;return o?-1===o.indexOf(t)?o+=t:r=!0:o=t,n.c.set(i,o,{expires:new Date((new Date).getTime()+6e4*e.blocktime)}),r},rand:function(t,e){return(t||this.du)+(!1===e?"":Math.floor(89999999*Math.random()+1e7).toString()).replace(".","")},open:function(n,i,o,r){var s,u,a=this,c=t.extend(!0,{},a.def,i);if(a.o=n,top!==e.self)try{top.document.location.toString()&&(a._top=top)}catch(t){}return!a.testStack(c.skip,a.ua)&&((!c.blocktime||typeof a.c!==a.fu||!a.cookieCheck(n,c))&&(n!==a.du&&(a.lastTarget=n,!0===a.first&&a.m===a.SWITCHER?(r&&typeof r.target!==a.u&&(s=a.getElementUrl(r,void 0),r.preventDefault()),a.switcher.switchWindow(s,a.o,a.rand(c.name,!i.name))):!0!==a.first&&!0!==a.isMultiple()||(a.m===a.TIMEOUT?e.setTimeout((u=t.extend(!0,{},a),function(){try{u.lastWin=e.open(u.o,u.rand(c.name,!i.name),u.getOptions(c.window))||u.lastWin,u.href(o,u),typeof c.cb===u.fu&&c.cb(u.lastWin)}catch(t){}}),0):a.lastWin=a._top.window.open(a.o,a.rand(c.name,!i.name),a.getOptions(c.window))||a.lastWin),a.m!==a.TIMEOUT&&(a.href(o,a),typeof c.cb===a.fu&&c.cb(a.lastWin))),!0))},bg:function(){var t=this;return(t.TIMEOUT===t.m||t.lastTarget)&&(t.m===t.SIMPLE?(t.switcher.simple(t),e.setTimeout(function(){t.switcher.simple(t)},500)):t.m===t.TIMEOUT&&t.switcher.timeout()),t},switcher:{simple:function(t){t.ua.oldIE?(t.lastWin.blur(),t.lastWin.opener.window.focus(),e.self.window.focus(),e.focus()):o.focus()},timeout:function(){e.setTimeout(function(){var t=e.open("","_self");t&&!t.closed&&t.focus()},0)},switchWindow:function(t,n,i){e.open(t,i),e.location.assign(n)}},isMultiple:function(){var t=this;return t.m===t.TIMEOUT||t.m===t.SIMPLE},href:function(t,e){return t&&e.lastTarget&&e.lastWin&&e.lastTarget!==e.b&&e.lastTarget!==e.o&&(e.lastWin.document.location.href=e.lastTarget),e},getElementUrl:function(e,n){var i,o,r=":submit, button",s=t(e.target),u=typeof n===this.u;return s.is("a")&&u?(i=s,o=s.attr("href")):!0!==s.is(r)?i=(s=s.parents(r)).parents("form"):(i=t(e.target.form),!s.is(r)||i&&i.length||(i=s.parents("form"))),o||0===s.length||0===i.length||"get"!==(i.prop("method")+"").toLowerCase()||"_blank"!==i.attr("target")&&!u||(o=i.attr("action")+"/?"+i.serialize()),o},reset:function(){var t=this;return t.last=!1,t.first=!0,t.lastTarget=t.lastWin=null,t},unbind:function(n,i){return this.reset(),n&&(n="string"==typeof n?t(n):n).off("submit."+this.ns),i&&((i="string"==typeof i?t(i):i).off("click."+this.ns).next(".jq-pu object").remove(),i.unwrap()),e.aPopunder=[],this},getOptions:function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(e+"="+t[e]);return n.join(",")}}}(jQuery,window,screen,navigator,document);