/*! jquery-plugin to create popunders in major browsers., 0.2.40 https://github.com/hpbuniat/jquery-popunder
Copyright (c) 2015 Hans-Peter Buniat, BSD license https://github.com/hpbuniat/jquery-popunder/blob/master/LICENSE*/
!function(a,b,c,d,e){"use strict";a.popunder=function(c,d,e,f){var g=a.popunder.helper,h="undefined";if(0===arguments.length&&(c=b.aPopunder),e||d)g.bindEvents(c,d,e);else if(c="function"==typeof c?c(f):c,(g.ua.ie===!0||g.ua.g===!0)&&(c=g.handleTargetBlank(c,f)),g.reset(),typeof c!==h){do g.queue(c,f);while(c.length>0);g.queue(c,f)}return a},a.popunder.helper={_top:b.self,lastWin:null,lastTarget:null,f:!1,last:!1,b:"about:blank",o:null,du:"__jqpu",ua:{ie:!!/msie|trident/i.test(d.userAgent),oldIE:!!/msie/i.test(d.userAgent),ff:!!/firefox/i.test(d.userAgent),o:!!/opera/i.test(d.userAgent),g:!!/chrome/i.test(d.userAgent),w:!!/webkit/i.test(d.userAgent),fl:!!d.mimeTypes["application/x-shockwave-flash"],flEnabled:!1},m:{g:"tab"},hs:[],ns:"jqpu",def:{window:{toolbar:0,scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1,width:(c.availWidth-122).toString(),height:(c.availHeight-122).toString(),screenX:0,screenY:0,left:0,top:0},name:"__pu",cookie:"__puc",blocktime:!1,chrome:{ex:"chrome/(4[1-9]|[5-9][d]).",noFlash:"chrome/(4[3-9]|[5-9][d])."},skip:{opera:!0,linux:!0,android:!0,iphone:!0,ipad:!0},cb:null,fs:!1,popup:!1,timer:[]},setMethod:function(a,b){var c=this;return c.m[a]=b,c},uaTest:function(a){return!!new RegExp(a,"i").test(d.userAgent.toString())},queue:function(a,b){var c=!1,d=this;if(a.length>0)for(;c===!1;){var e=a.shift();c=e?d.open(e[0],e[1]||{},a.length,b):!0}else d.last===!1?(d.last=!0,d.bg().href(!0)):d.f||d.ua.g||d.ua.ie||d.bg();return d},handler:function(a,b){var c=this;"function"==typeof c.hs[a]&&c.hs[a](b)},getTrigger:function(b){return a("#"+b).parents(".jq-pu").children().eq(0)},trigger:function(b){var c=this,d=c.getTrigger(b);c.last&&c.ua.g===!0&&"overlay"===c.m.g&&setTimeout(a.proxy(function(a){a.next("object").unwrap().remove()},null,d),1),d.trigger("click")},bindEvents:function(b,c,d){var e=this,f="string",g=e.hs.length,h=function(a){return function(b){e.handler(a,b)}}(g);return e.hs[g]=function(b){return function(c){return c&&!c.target&&(c={target:e.getTrigger(c)}),a.popunder(b,!1,!1,c),!0}}(b),c&&!e.ua.g&&(c=typeof c===f?a(c):c,c.on("submit."+e.ns,h)),d&&(d=typeof d===f?a(d):d,d.on("click."+e.ns,h),e.ua.g&&(e.def.skip[e.def.chrome.ex]=!0,e.def.skip[e.def.chrome.noFlash]=!0,e.def.fs&&e.ua.fl&&!e.uaTest(e.def.chrome.noFlash)&&(e.def.timer[g]=setInterval(a.proxy(function(a,b,c){a.is(":hidden")||(c.overlay(a,b),clearInterval(c.def.timer[b]))},this,d,g,e),500)))),e},overlay:function(b,c){var d=this;return b.each(function(){var b=a(this);b.parent(".jq-pu").length&&d.unbind(b.parents("form:eq(0)"),b);var e="absolute",f=b.css("position")===e?"":"position:relative;",g=d.rand("pub"),h=b.wrap('<div class="jq-pu '+g+'" style="display:inline-block; '+f+'" />').parent(),i=a.extend(!0,{},{position:e,cursor:"pointer",top:f?0:b.css("top"),left:f?0:b.css("left"),padding:b.css("padding"),margin:b.css("margin"),width:b.width(),height:b.height()}),j=a('<object id="'+g+'" type="application/x-shockwave-flash" data="'+d.def.fs+'" />').css({width:1,height:1}).data(d.ns,i);j.append('<param name="wmode" value="transparent" />'),j.append('<param name="menu" value="false" />'),j.append('<param name="allowScriptAccess" value="always" />'),j.append('<param name="flashvars" value="'+a.param({id:g,hs:c})+'" />'),h.append(j),d.toggleFl("overlay"===d.m.g,g)}),d},loadfl:function(){var a=this;return a.ua.flEnabled=!0,a.toggleFl(!0),a},toggleFl:function(b,c){b=!!b;var d=this,e=a("."+c),f=e.css("zIndex"),g=e.find("object");return g.data(d.ns)&&1===parseInt(g.width())&&g.css(g.data(d.ns)),!0===b&&!0===d.ua.g&&!0===d.ua.flEnabled?(d.setMethod("g","overlay"),g.css("zIndex","auto"),d.def.skip[d.def.chrome.ex]=!1):(d.setMethod("g","tab"),g.css("zIndex",parseInt("auto"===f?0:f)-1),d.def.skip[d.def.chrome.ex]=!0),d},cookieCheck:function(b,c){var d=this,e=d.rand(c.cookie,!1),f=a.cookie(e),g=!1;return f?-1===f.indexOf(b)?f+=b:g=!0:f=b,a.cookie(e,f,{expires:new Date((new Date).getTime()+6e4*c.blocktime)}),g},rand:function(a,b){var c=this,d=a?a:c.du;return d+(b===!1?"":Math.floor(89999999*Math.random()+1e7).toString()).replace(".","")},open:function(c,d,e){var f,g,h,i=this,j="function";if(g=a.extend(!0,{},i.def,d),h=g.skip,i.o=c,top!==b.self)try{top.document.location.toString()&&(i._top=top)}catch(k){}for(f in h)if(h.hasOwnProperty(f)&&h[f]===!0&&i.uaTest(f))return!1;return g.blocktime&&typeof a.cookie===j&&i.cookieCheck(c,g)?!1:(c!==i.du&&(i.lastTarget=c,i.ua.g===!0&&"tab"===i.m.g?i.switcher.tab(i,i.o):i.lastWin=i._top.window.open(i.o,i.rand(g.name,!d.name),i.getOptions(g.window))||i.lastWin,i.ua.ff===!0&&i.bg(),i.href(e),typeof g.cb===j&&g.cb(i.lastWin)),!0)},bg:function(a){var b=this;return b.lastWin&&b.lastTarget&&!a?b.ua.ie===!0?b.switcher.simple(b):b.ua.g||b.switcher.pop(b):"oc"===a&&b.switcher.pop(b),b},switcher:{simple:function(a){try{a.lastWin.blur()}catch(c){}b.focus()},pop:function(a){!function(b){try{a.f=b.window.open("about:blank"),a.f&&a.f.close()}catch(c){}try{b.opener.window.focus()}catch(c){}}(a.lastWin)},tab:function(c,d){var f=d?d:"data:text/html,<script>window.close();</script>;",g=!d,h=a("<a/>",{href:f}).appendTo(e.body),i=e.createEvent("MouseEvents");return g="tab"===c.m.g?!g:g,i.initMouseEvent("click",!0,!0,b,0,0,0,0,0,g,!1,!g,g,0,null),h[0].dispatchEvent(i),h[0].parentNode.removeChild(h[0]),c}},href:function(a){var b,c=this;return a&&c.lastTarget&&c.lastWin&&c.lastTarget!==c.b&&c.lastTarget!==c.o&&(c.ua.g===!0&&"simple"!==c.m.g?(b=c.lastWin.document,b.open(),b.write("<html><head><title>"+e.title+'</title><script type="text/javascript">window.location="'+c.lastTarget+'";</script></head><body></body></html>'),b.close()):c.lastWin.document.location.href=c.lastTarget),c},handleTargetBlank:function(b,c){if(c&&"undefined"!=typeof c.target){var d,e=this,f=null,g=a(c.target);g.is('input[type="submit"]')===!0&&(f=c.target.form),f&&"_blank"===f.target&&(d=e.du,e.ua.ie&&(d=f.action+"/?"+a(f).serialize()),b.unshift([d,{popup:!0}]))}return b},reset:function(){var a=this;return a.f=a.last=!1,a.lastTarget=a.lastWin=null,a},unbind:function(c,d){var e=this,f="string";return e.reset(),c&&(c=typeof c===f?a(c):c,c.off("submit."+e.ns)),d&&(d=typeof d===f?a(d):d,d.off("click."+e.ns).next(".jq-pu object").remove(),d.unwrap()),b.aPopunder=[],e},getOptions:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b+"="+a[b]);return c.join(",")}}}(jQuery,window,screen,navigator,document);